<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Configuraci√≥n ‚Ä¢ Hub de Indicadores</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
    rel="stylesheet" />
  <link href="popup.css" rel="stylesheet">
</head>

<body
  class="bg-background-dark text-slate-100 font-display min-h-screen flex justify-center antialiased selection:bg-primary/30 selection:text-primary">
  <div class="w-full max-w-7xl flex min-h-screen mx-auto relative">
    <!-- Sidebar Navigation -->
    <aside class="w-64 border-r border-white/5 flex flex-col shrink-0 h-screen sticky top-0">
      <div class="py-5 px-6 border-b border-white/5 flex items-center shrink-0">
        <div class="font-display font-extrabold text-xl text-primary flex items-center gap-2 tracking-tight">Indicadores
          <span
            class="bg-primary text-background-dark font-bold text-[10px] px-1.5 py-0.5 rounded uppercase tracking-wider">HUB</span>
        </div>
      </div>
      <ul class="list-none p-0 mx-0 flex-grow py-6">
        <div class="space-y-2 mt-4">
          <!-- Hub Architecture Menu -->
          <button data-provider="config"
            class="w-full text-left px-4 py-3 rounded-xl font-bold text-sm bg-white/10 text-white transition-all flex items-center justify-between group shadow-sm">
            <div class="flex items-center gap-3">
              <span class="text-lg">‚öôÔ∏è</span> Configuraci√≥n APIs
            </div>
            <div class="w-1.5 h-1.5 rounded-full bg-primary animate-pulse"></div>
          </button>
          <button data-provider="explorer"
            class="w-full text-left px-4 py-3 rounded-xl font-semibold text-sm text-text-muted hover:bg-white/5 hover:text-white transition-all flex items-center justify-between group">
            <div class="flex items-center gap-3">
              <span class="text-lg">üìä</span> Explorador de Datos
            </div>
          </button>
        </div>

      </ul>
      <div class="p-6 border-t border-white/5 mt-auto">
        <p class="text-[11px] text-text-muted m-0">Hecho por <a href="https://alasha.biz" target="_blank"
            class="text-text-muted hover:text-primary transition-colors">Alasha Collective</a></p>
      </div>
    </aside>

    <!-- Workspace area -->
    <main class="flex-1 flex flex-col min-w-0">
      <header
        class="py-5 border-b border-white/5 flex items-center justify-between px-8 shrink-0 bg-background-dark/95 backdrop-blur z-10 sticky top-0">
        <h2 id="providerTitle" class="font-display font-bold text-lg m-0 text-white">Banxico (M√©xico)</h2>
        <div id="globalMsg" class="text-sm flex items-center gap-1.5 font-medium hidden"></div>
      </header>

      <div class="p-10 flex items-start gap-10 w-full mx-auto relative">
        <!-- Active Provider Control Area -->
        <section class="flex-1 min-w-0">

          <!-- Hub: Configuraci√≥n APIs -->
          <div id="viewConfig" class="provider-view space-y-6">
            <div class="bg-card-dark p-5 rounded-2xl border border-white/5">
              <div class="mb-5">
                <h2 class="font-display font-semibold text-lg text-white m-0">Obt√©n Datos de Banxico</h2>
                <p class="text-text-muted text-sm mt-1 mb-0">Accede a tasas de inter√©s, inflaci√≥n y reportes oficiales
                  en tiempo real.</p>
              </div>
              <div class="mb-5">
                <div class="flex justify-between items-center mb-2">
                  <label for="token" class="block font-bold text-[11px] uppercase tracking-wider text-text-muted m-0">Tu
                    Token de Acceso</label>
                  <a href="https://www.banxico.org.mx/SieAPIRest/service/v1/token" target="_blank"
                    class="text-[11px] font-semibold text-primary hover:text-primary-alt transition-colors no-underline">Obtener
                    token gratis en Banxico ‚Üó</a>
                </div>
                <div class="flex flex-col gap-2.5">
                  <input id="token" type="text" placeholder="Pega tu token aqu√≠"
                    class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all">
                </div>
                <div id="msgSie" class="text-xs mt-2 flex items-center gap-1.5 font-medium min-h-[20px] hidden"></div>
              </div>
              <button id="saveBanxico"
                class="px-5 py-3 rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 bg-primary/15 text-primary border border-primary/30 hover:bg-primary/25 w-full">Activar
                Integraci√≥n de Banxico</button>
            </div>

            <div class="bg-card-dark border border-white/5 rounded-2xl p-6">
              <h2 class="font-display font-semibold text-xl text-white m-0">Obt√©n Datos de INEGI</h2>
              <p class="text-text-muted text-sm mt-1 mb-6">Accede a estad√≠sticas sociodemogr√°ficas y econ√≥micas de
                M√©xico.</p>

              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <label class="text-[11px] font-bold text-text-muted uppercase tracking-wider block">Tu Token de
                    Acceso</label>
                  <a href="https://www.inegi.org.mx/servicios/api_indicadores.html" target="_blank"
                    class="text-xs text-primary hover:text-primary/80 transition-colors">Obtener token gratis en INEGI
                    ‚Üó</a>
                </div>
                <div class="flex flex-col gap-2.5">
                  <input id="inegiToken" type="text" placeholder="Pega tu token aqu√≠"
                    class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all">
                </div>
                <div id="msgInegi" class="text-xs mt-2 flex items-center gap-1.5 font-medium min-h-[20px] hidden"></div>
              </div>

              <div class="mt-4">
                <button id="saveInegi"
                  class="w-full px-6 py-3 rounded-xl font-bold text-base transition-all flex items-center justify-center gap-2 bg-primary/15 text-primary border border-primary/30 hover:bg-primary/25 disabled:opacity-50 disabled:cursor-not-allowed">
                  Activar Integraci√≥n de INEGI
                </button>
              </div>
            </div>

            <div class="bg-card-dark p-5 rounded-2xl border border-white/5">
              <div class="flex justify-between items-start mb-5">
                <div>
                  <h2 class="font-display font-semibold text-lg text-white m-0">Commodities y Mercados Globales</h2>
                  <p class="text-text-muted text-sm mt-1 mb-0">Acciones, materias primas y cripto (V√≠a Yahoo Finance).
                  </p>
                </div>
                <div
                  class="h-12 w-12 rounded-lg bg-primary/10 border border-white/5 flex items-center justify-center text-2xl shrink-0">
                  üåç</div>
              </div>
              <p class="m-0 text-sm text-text-muted leading-relaxed">
                <span class="text-success">‚úÖ</span> <b>No necesitas una API Key</b>. Hemos implementado un motor
                ultra-r√°pido que lee materias primas y commodities en tiempo real.
              </p>
            </div>
          </div>

          <!-- Hub: Explorador de Datos -->
          <div id="viewExplorer" class="provider-view hidden space-y-6">
            <div class="flex gap-2 overflow-x-auto no-scrollbar mb-4 border-b border-white/5 pb-4">
              <button
                class="explorer-filter active px-4 py-2 rounded-lg bg-primary/10 text-primary text-sm font-bold transition-colors"
                data-filter="all">Todos</button>
              <button
                class="explorer-filter px-4 py-2 rounded-lg text-text-muted hover:bg-white/5 text-sm font-semibold transition-colors"
                data-filter="banxico">Banxico</button>
              <button
                class="explorer-filter px-4 py-2 rounded-lg text-text-muted hover:bg-white/5 text-sm font-semibold transition-colors"
                data-filter="inegi">INEGI</button>
              <button
                class="explorer-filter px-4 py-2 rounded-lg text-text-muted hover:bg-white/5 text-sm font-semibold transition-colors"
                data-filter="yf">Mercado y Cripto</button>
            </div>

            <!-- Banxico Explorer -->
            <div class="explorer-card transition-all duration-300" data-category="banxico">
              <div id="banxicoOps" class="locked-overlay locked relative transition-all duration-300">
                <div
                  class="unlock-notice absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-card-dark border border-primary text-white px-6 py-4 rounded-xl text-center z-10 w-4/5 hidden shadow-2xl font-medium">
                  ¬°Casi listo! Ve a Configuraci√≥n APIs e ingresa tu token para desbloquear el cat√°logo de Banxico.</div>
                <div class="locked-content transition-all duration-300">
                  <div class="bg-card-dark rounded-2xl border border-white/5 overflow-hidden">
                    <div class="p-6 border-b border-white/5">
                      <div class="mb-5">
                        <h2 class="font-display font-semibold text-lg text-white m-0">Cat√°logo: Banxico <span
                            class="text-sm font-normal text-text-muted ml-2">Indicadores Populares</span></h2>
                      </div>
                      <div id="banxicoButtons" class="flex flex-wrap gap-2 mt-4"></div>
                    </div>
                    <div class="p-6">
                      <div class="mb-5">
                        <h2 class="font-display font-semibold text-lg text-white m-0">A√±adir por ID</h2>
                        <p class="text-text-muted text-sm mt-1 mb-0">Busca IDs en el <a
                            href="https://www.banxico.org.mx/SieAPIRest/service/v1/doc/catalogoSeries" target="_blank"
                            class="text-primary hover:underline">cat√°logo SIE</a>.</p>
                      </div>
                      <div class="flex flex-wrap sm:flex-nowrap gap-3 mt-4">
                        <input id="seriesId" type="text" placeholder="Ej. SF43718"
                          class="w-full sm:w-40 bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all uppercase">
                        <select id="seriesType"
                          class="w-full sm:w-24 bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all appearance-none cursor-pointer">
                          <option value="percent">% (Porcentaje)</option>
                          <option value="currency">$ (Moneda)</option>
                          <option value="number"># (N√∫mero)</option>
                        </select>
                        <button id="addById"
                          class="px-5 py-3 rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 bg-primary/15 text-primary border border-primary/30 hover:bg-primary/25 w-full sm:w-auto">A√±adir</button>
                      </div>
                      <div id="seriesMsg" class="text-xs mt-2 flex items-center gap-1.5 font-medium min-h-[20px]"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- INEGI Explorer -->
            <div class="explorer-card transition-all duration-300" data-category="inegi">
              <div id="inegiOps" class="locked-overlay locked relative transition-all duration-300">
                <div id="inegiOverlay1"
                  class="unlock-notice hidden absolute inset-0 bg-background-dark/80 backdrop-blur-sm z-10 flex flex-col items-center justify-center transition-opacity duration-300">
                  <div class="bg-card-dark p-4 rounded-xl border border-white/10 text-center max-w-sm mx-4 shadow-xl">
                    <span class="material-symbols-outlined text-3xl text-primary mb-2">lock</span>
                    <p class="text-sm text-white font-medium m-0">¬°Casi listo! Ve a Configuraci√≥n APIs e ingresa tu
                      token para desbloquear estad√≠sticas nacionales.</p>
                  </div>
                </div>
                <div class="locked-content transition-all duration-300">
                  <div class="bg-card-dark rounded-2xl border border-white/5 overflow-hidden">
                    <div class="p-6 border-b border-white/5">
                      <div class="mb-5">
                        <h2 class="font-display font-semibold text-lg text-white m-0">Cat√°logo: INEGI <span
                            class="text-sm font-normal text-text-muted ml-2">Sugeridos</span></h2>
                      </div>
                      <div id="inegiButtons" class="flex flex-wrap gap-2 mt-4"></div>
                    </div>
                    <div class="p-6">
                      <div class="mb-5">
                        <h2 class="font-display font-semibold text-lg text-white m-0">A√±adir por ID</h2>
                        <p class="text-text-muted text-sm mt-1 mb-0">Busca en el <a
                            href="https://www.inegi.org.mx/servicios/api_indicadores.html" target="_blank"
                            class="text-primary hover:underline">constructor</a> o usa <a href="#" id="openInegiHelp"
                            class="text-primary font-semibold hover:underline">esta gu√≠a r√°pida</a>.</p>
                      </div>
                      <div class="flex flex-wrap sm:flex-nowrap gap-3 mt-4">
                        <input id="inegiIdInput" type="text" placeholder="Ej. 1002000001"
                          class="flex-1 sm:flex-none sm:w-48 bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all">
                        <button id="addInegiById"
                          class="px-5 py-3 rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 bg-primary/15 text-primary border border-primary/30 hover:bg-primary/25 w-full sm:w-auto">A√±adir</button>
                      </div>
                      <div id="inegiMsg" class="text-xs mt-2 flex items-center gap-1.5 font-medium min-h-[20px]"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Yahoo Finance Explorer -->
            <div class="explorer-card transition-all duration-300" data-category="yf">
              <div id="avOps">
                <div class="bg-card-dark rounded-2xl border border-white/5 overflow-hidden">
                  <div class="p-6 border-b border-white/5">
                    <div class="mb-5">
                      <h2 class="font-display font-semibold text-lg text-white m-0">Cat√°logo: Mercados Globales <span
                          class="text-sm font-normal text-text-muted ml-2">Sugeridos</span></h2>
                    </div>
                    <div id="stocksButtons" class="flex flex-wrap gap-2 mt-4"></div>
                    <div id="avButtons" class="flex flex-wrap gap-2 mt-2"></div>
                  </div>
                  <div class="p-6">
                    <div class="mb-5">
                      <h2 class="font-display font-semibold text-lg text-white m-0">A√±adir Ticker Manual (V√≠a Yahoo
                        Finance)</h2>
                      <p class="mt-2 text-sm text-text-muted hidden" id="stockHelpText">
                        <strong>¬øNo sabes cu√°l es el ticker?</strong> Ve a <a href="https://finance.yahoo.com/"
                          target="_blank" class="text-primary font-semibold hover:underline">Yahoo Finance</a>, busca el
                        nombre de la empresa, √≠ndice o criptomoneda en su barra de b√∫squeda. El c√≥digo que aparece entre
                        par√©ntesis es el Ticker (Ejemplo: Para Am√©rica M√≥vil aparece <strong>AMXL.MX</strong>).
                      </p>
                    </div>
                    <div class="flex flex-wrap sm:flex-nowrap gap-3 mb-2">
                      <input id="stockInput" type="text" placeholder="Ej. TSLA, NVDA"
                        class="flex-1 sm:flex-none sm:w-48 bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-sm font-medium text-white outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all uppercase">
                      <button id="addStockBtn"
                        class="px-5 py-3 rounded-lg font-bold text-sm transition-all flex items-center justify-center gap-2 bg-primary/15 text-primary border border-primary/30 hover:bg-primary/25 w-full sm:w-auto">A√±adir</button>
                      <button id="toggleStockHelp"
                        class="px-3 py-3 rounded-lg font-bold text-sm text-text-muted transition-all flex items-center justify-center hover:bg-white/5 border border-transparent"
                        title="Ayuda sobre Tickers">?</button>
                    </div>
                    <div id="stockMsg" class="text-xs mt-2 flex items-center gap-1.5 font-medium min-h-[20px]"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </section>

        <!-- Persistent Selection Side Panel -->
        <aside class="w-80 shrink-0 sticky top-28" style="height: calc(100vh - 8rem);">
          <div class="bg-card-dark border border-white/5 rounded-2xl h-full flex flex-col overflow-hidden">
            <div class="p-5 border-b border-white/5 shrink-0">
              <h2 class="font-display font-semibold text-lg text-white m-0">Mi Tablero</h2>
              <p class="text-text-muted text-xs mt-1 mb-0">Tu tablero se guarda autom√°ticamente y est√° listo para usar
                en tu extensi√≥n.</p>
            </div>
            <div id="selected" class="flex-1 p-4 overflow-y-auto space-y-2 no-scrollbar relative min-h-[200px]">
              <!-- Empty state injects here -->
              <div id="selectedEmptyState"
                class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center opacity-70">
                <span class="material-symbols-outlined text-4xl text-text-muted mb-3">dashboard_customize</span>
                <h3 class="text-sm font-semibold text-white m-0 tracking-wide">Tu tablero est√° vac√≠o</h3>
                <p class="text-xs text-text-muted mt-2">A√±ade indicadores clave desde los paneles de la izquierda para
                  empezar a armar tu dashboard.</p>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <div id="inegiHelpModal"
    class="fixed inset-0 bg-background-dark/80 backdrop-blur-sm z-[1000] hidden items-center justify-center p-4">
    <div
      class="glass-card bg-card-dark p-8 rounded-2xl border border-white/5 w-full max-w-[550px] shadow-2xl relative transition-all">
      <button id="closeInegiHelp"
        class="absolute top-4 right-4 text-text-muted hover:text-white bg-white/5 hover:bg-white/10 rounded-full w-8 h-8 flex items-center justify-center transition-colors text-lg">√ó</button>
      <h2 class="font-display font-semibold text-lg text-white m-0">C√≥mo encontrar IDs del INEGI</h2>
      <p class="text-text-muted text-sm mt-1 mb-5">Sigue estos pasos para encontrar el ID correcto para cualquier
        indicador.</p>

      <img src="assets/inegi_guide.png" alt="Gu√≠a visual INEGI" class="w-full rounded-lg border border-white/5 mb-6">

      <ol class="list-decimal pl-4 mb-6 space-y-2 text-sm text-text-muted marker:text-text-muted">
        <li>Entra a la <a href="https://www.inegi.org.mx/servicios/api_indicadores.html" target="_blank"
            class="font-semibold text-primary hover:text-primary-alt transition-colors">p√°gina de la API de INEGI</a>.
        </li>
        <li>Ve a la pesta√±a <strong class="text-white font-medium">"Constructor de Consultas"</strong> (como se ve en
          la
          imagen).</li>
        <li>Navega por el √°rbol de temas (ej. <em>Precios e Inflaci√≥n</em>) y selecciona tu indicador.</li>
        <li>El ID es el n√∫mero que aparece en la columna <strong class="text-white font-medium">"Clave"</strong> (ej.
          <code class="bg-white/10 px-1.5 py-0.5 rounded text-primary">628194</code>).
        </li>
      </ol>

      <div class="bg-background-dark/50 p-4 rounded-lg border border-white/5">
        <h3 class="m-0 mb-2 text-sm font-semibold flex items-center gap-2"><span
            class="text-warning text-base">‚ö†Ô∏è</span> <span class="text-white">Importante</span></h3>
        <ul class="m-0 pl-4 space-y-1 text-sm text-text-muted list-disc marker:text-text-muted/50">
          <li>Si buscas <strong class="text-white font-medium">variaciones porcentuales</strong> (ej. PIB), aseg√∫rate
            de
            que el indicador diga "Variaci√≥n anual" o "trimestral" en su nombre, no solo el valor absoluto en
            millones.
          </li>
          <li>Para comparaciones mes a mes, busca series <strong
              class="text-white font-medium">Desestacionalizadas</strong>.</li>
        </ul>
      </div>
    </div>
  </div>

  <script type="module" src="onboarding.js"></script>
</body>

</html>