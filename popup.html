<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="shell">
    <div id="mainView">
      <div class="header">
        <div>
          <h3>Indicadores Banxico</h3>
          <p id="lastUpdated" class="muted" style="margin:2px 0">Actualizado: —</p>
        </div>
        <div class="loading" id="loading">Cargando…</div>
        <button id="refresh" class="btn">Actualizar</button>
      </div>
      <div id="warning" class="warn">
        Falta tu token SIE. <a href="onboarding.html" class="link" target="_blank">Configúralo aquí</a>.
      </div>
      <table>
        <thead>
          <tr>
            <th>Indicador</th>
            <th>Valor</th>
            <th>Fecha</th>
            <th style="width:20px;"></th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>

      <div class="calculator-section">
        <h3>Calculadora de UDIs</h3>
        <div class="calc-grid">
          <div class="calc-field">
            <label for="calcAmount">Monto</label>
            <input type="number" id="calcAmount" class="calc-input" placeholder="0.00" step="0.01">
          </div>
          <div class="calc-field">
            <label id="calcModeLabel">UDIs &rarr; Pesos</label>
            <button id="swapMode" class="btn" style="width: 100%; height: 38.5px; padding: 0;">⇅ Intercambiar</button>
          </div>
        </div>
        <div id="calcResult" class="calc-result">
          Esperando datos...
        </div>
        <div id="calcDate" class="muted" style="text-align:center; margin-top:8px"></div>
      </div>

      <div id="toast" class="toast"></div>

      <p class="muted">Fuente: SIE Banxico &middot; <a href="https://alasha.biz" target="_blank"
          class="link">alasha.biz</a></p>
    </div>
    <div id="historicalView">
      <div id="historicalHeader">
        <h3 id="historicalTitle"></h3>
        <button id="backToList" class="btn">← Volver</button>
      </div>
      <div id="dateControls">
        <label for="startDate">Desde:</label>
        <input type="date" id="startDate">
        <label for="endDate">Hasta:</label>
        <input type="date" id="endDate">
        <button id="updateHistory" class="btn">Ver</button>
      </div>
      <div id="historicalTableContainer">
        <!-- La tabla de datos históricos se insertará aquí -->
      </div>
      <div id="noDataMessage" style="display: none; padding: 20px; text-align: center; color: var(--muted);">
        <p>No se encontraron datos para este rango de fechas.</p>
      </div>
      <div id="historicalError"></div>
    </div>
  </div>
  <script type="module" src="popup.js"></script>